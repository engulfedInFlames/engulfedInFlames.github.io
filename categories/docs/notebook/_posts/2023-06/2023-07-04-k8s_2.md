---
title: "ì¿ ë²„ë„¤í‹°ìŠ¤ (2) : ë¯¸ë‹ˆì¿ ë² (Minikube)"
tags: [k8s]
sidebar:
  nav: categories
permalink: /categories/docs/notebook/k8s_2/
article_header:
  type: cover
  image:
    src: /assets/images/docs/notebook/kubernetes-banner.svg
---

<div class="article__content" markdown="1">

## âœ… ë¯¸ë‹ˆì¿ ë²  ì„¤ì¹˜í•˜ê¸°

### ë¯¸ë‹ˆì¿ ë² (Minikube)ë€?

> minikube is local Kubernetes, focusing on making it easy to learn and develop for Kubernetes.

&ensp; ë¯¸ë‹ˆì¿ ë² ëŠ” ë¡œì»¬ í™˜ê²½ì—ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤(ì´í•˜ k8s)ë¥¼ ë°°ìš¸ ìˆ˜ ìˆëŠ” í™˜ê²½ì„ ì œê³µí•©ë‹ˆë‹¤. ìµœê·¼ ì•± ê°œë°œì—ì„œ ì•± ê´€ë¦¬ ë° ë°°í¬ì˜ ì¤‘ìš”ì„±ì´ ì ì  ì¦ëŒ€ë¨ì— ë”°ë¼, ì´ì— í° ì´ì ì„ ì œê³µí•˜ëŠ” k8sê°€ ê°ê´‘ë°›ê³  ìˆìŠµë‹ˆë‹¤. ë¯¸ë‹ˆì¿ ë² ëŠ” ê·¸ ë¡œì»¬ ë²„ì „ì´ë¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

&ensp; ì—¬íƒœê» ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ëŠ” ì •ë„ì— ë¨¸ë¬¼ë €ì§€ë§Œ, ì´ë²ˆ ê¸°íšŒì— ë¯¸ë‹ˆì¿ ë² ë¥¼ ì‚¬ìš©í•˜ì—¬ k8së¡œ ë„ì»¤ ì»¨í…Œì´ë„ˆ ê´€ë¦¬ë¥¼ ìë™í™”í•˜ëŠ” ë°©ë²•ì„ ë°°ì›Œë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

### ë¯¸ë‹ˆì¿ ë²  ì„¤ì¹˜í•˜ê¸°

&ensp; ì„¤ì¹˜ëŠ” ê°„ë‹¨í•©ë‹ˆë‹¤. ë¯¸ë‹ˆì¿ ë²  [ê³µì‹ ë¬¸ì„œ](https://minikube.sigs.k8s.io/docs/start/)ë¥¼ í™•ì¸í•˜ì„¸ìš”.

### kubectl

&ensp; `kubectl`ì€ ë¡œì»¬ì—ì„œ k8së¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ì»¤ë§¨ë“œ ë¼ì¸ íˆ´ì…ë‹ˆë‹¤. ë¯¸ë‹ˆì¿ ë² ë¥¼ í†µí•´ ë¡œì»¬ì—ì„œ k8s ì‹±ê¸€ í´ëŸ¬ìŠ¤í„°ë¥¼ ìš´ìš©í•  ìˆ˜ ìˆê³ , ì´ í´ëŸ¬ìŠ¤íŠ¸ë¡¤ ì œì–´í•˜ê¸° ìœ„í•´ì„œëŠ” `kubectl`ë¡œ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.

&ensp; ì´ ì—­ì‹œ ì„¤ì¹˜ëŠ” ê°„ë‹¨í•©ë‹ˆë‹¤. k8s [ê³µì‹ ë¬¸ì„œ](https://kubernetes.io/docs/tasks/tools/)ë¥¼ í™•ì¸í•˜ì„¸ìš”.

<br/>

## âœ… í”„ë¡œì íŠ¸ ë‹¤ìš´ë¡œë“œí•˜ê¸°

&ensp; í”„ë¡œì íŠ¸ëŠ” ì´ [ì˜ìƒ](https://www.youtube.com/watch?v=fw0KXPLFFgs)ì—ì„œ ì œê³µí•˜ëŠ” ê¹ƒí—ˆë¸Œ í”„ë¡œì íŠ¸ë¥¼ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ê°„ë‹¨í•˜ê²Œ ë„ì»¤ë¡œ ì‹¤í–‰ ê°€ëŠ¥í•œ ì¥ê³  í”„ë¡œì íŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ê¹ƒìœ¼ë¡œ í´ë¡ í•˜ì—¬ ë¡œì»¬ì— ë‹¤ìš´ë¡œë“œí•˜ê³ , ë£¨íŠ¸ ê²½ë¡œì—ì„œ `docker compose up -d` ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ì—¬ ê³§ë°”ë¡œ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

<br/>

## âœ… ë¯¸ë‹ˆì¿ ë² ë¡œ ë¡œì»¬ì— k8s ì‹±ê¸€ í´ëŸ¬ìŠ¤í„° ì‹¤í–‰í•˜ê¸°

### í´ëŸ¬ìŠ¤í„° ì„¤ì¹˜í•˜ê¸°

```zsh
mininkube start
```

&ensp; ë¯¸ë‹ˆì¿ ë² ê°€ ì˜ ì„¤ì¹˜ëë‹¤ë©´, ìœ„ ëª…ë ¹ì–´ë¡œ ë¡œì»¬ì— k8s ì‹±ê¸€ í´ëŸ¬ìŠ¤í„°ë¥¼ ì„¤ì¹˜(ì‹¤í–‰)í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í´ëŸ¬ìŠ¤íŠ¸ ì•ˆì—ëŠ” ë…¸ë“œë“¤ì´ ì¡´ì¬í•˜ë©°, **ë…¸ë“œ**ë€ ì»¨í…Œì´ë„ˆí™” ëœ ì•±ë“¤ì´ ì‹¤í–‰ë˜ëŠ” ê³µê°„ì…ë‹ˆë‹¤. ë¯¸ë‹ˆì¿ ë² ì—ì„œ ì˜µì…˜ í”Œë˜ê·¸ë¡œ ì‹¤í–‰í•  ë…¸ë“œì˜ ê°œìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 3ê°œì˜ ë…¸ë“œë¥¼ ê°€ì§„ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‹¤í–‰í•˜ê³  ì‹¶ë‹¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.

```zsh
minikube start --nodes 3
```

### ëŒ€ì‹œë³´ë“œ

```zsh
minikube dashboard
```

&ensp; AWSì˜ EKSì™€ ê°™ì´ k8s ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” í”Œë«í¼ì—ì„œëŠ” k8s í´ëŸ¬ìŠ¤í„°ì™€ ë…¸ë“œë“¤ì„ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ë¯¸ë‹ˆì¿ ë² ì—ì„œë„ ì•½ì†Œí•˜ê²Œ ë‚˜ë§ˆ ëŒ€ì‹œë³´ë“œë¥¼ í†µí•´ í´ëŸ¬ìŠ¤í„°ì™€ ë…¸ë“œë“¤ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ëŒ€ì‹œë³´ë“œì˜ ì‘ë™ ë°©ì‹

```zsh
ğŸ”Œ  Enabling dashboard ...
    â–ª Using image docker.io/kubernetesui/dashboard:v2.7.0
    â–ª Using image docker.io/kubernetesui/metrics-scraper:v1.0.8
ğŸ’¡  Some dashboard features require the metrics-server addon. To enable all features please run:

        minikube addons enable metrics-server


ğŸ¤”  Verifying dashboard health ...
ğŸš€  Launching proxy ...
ğŸ¤”  Verifying proxy health ...
ğŸ‰  Opening http://127.0.0.1:44147/api/v1/namespaces/kubernetes-dashboard/services/http:kubernetes-dashboard:/proxy/ in your default browser...
ğŸ‘‰  http://127.0.0.1:44147/api/v1/namespaces/kubernetes-dashboard/services/http:kubernetes-dashboard:/proxy/
```

&ensp; `minikube dashboard` ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´ ë¯¸ë‹ˆì¿ ë² ê°€ ìì²´ì ìœ¼ë¡œ ê°€ìƒí™”ëœ ì„œë²„ë¥¼ ìƒì„±í•˜ê³ , í”„ë¡ì‹œê°€ í™œì„±í™”ë©ë‹ˆë‹¤. ì‚¬ìš©ìëŠ” ì½˜ì†”ì— ì¶œë ¥ëœ URLë¡œ ì ‘ì†í•˜ì—¬ ë¸Œë¼ìš°ì €ì—ì„œ ë¯¸ë‹ˆì¿ ë²  ëŒ€ì‹œë³´ë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![Kubernetes Dashboard](/assets/images/docs/notebook/k8s/k8s_1.png){:.shadow}

<br/>

## âœ… kustomization.yaml

&ensp; í‘œì¤€í™”ëœ ê°œë°œ ë°©ë²•ì´ ì •í•´ì ¸ ìˆëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤ë§Œ, ì»¨ë²¤ì…˜ì„ ì¤€ìˆ˜í•˜ëŠ” ê²ƒì€ ì•ˆì •ì ì¸ ê°œë°œ, ìš´ì˜ì„ ìœ„í•´ í•„ìˆ˜ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. k8së„ í”„ë¡œì íŠ¸ ì…‹ì—…ì—ì„œ ì»¨ë²¤ì…˜ì´ ìˆìŠµë‹ˆë‹¤.

- ë£¨íŠ¸ ê²½ë¡œì— _deploy/kustomization.yaml_ ìƒì„±

&ensp; *kustomization.yaml*ì€ k8sì˜ ë£¨íŠ¸ _config_ íŒŒì¼ì´ë¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°œë³„ í¬ë“œì— ëŒ€í•´ì„œ YAML íŒŒì¼ì„ ì‘ì„±í•œ ë‹¤ìŒì— *kustomization.yaml*ì—ì„œ ì¤‘ì•™ ì œì–´í•˜ê²Œë” í•˜ëŠ” ê²ƒì´ ì»¨ë²¤ì…˜ì¸ ê²ƒì…ë‹ˆë‹¤. ê°„ë‹¨í•˜ê²Œ *kustomization.yaml*ì„ ì •ì˜í•˜ê³  í¬ìŠ¤íŠ¸ê·¸ë ˆ í¬ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ë°ê¹Œì§€ë§Œ ì§„í–‰í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

### kustomization.yaml

```yaml
secretGenerator: # k8sì— ì‹œí¬ë¦¿ì„ ì¶”ê°€í•˜ëŠ” ë°©ë²•
  # ì‹¤ì œ gitì— ì»¤ë°‹í•  ë•ŒëŠ” ì‚¬ìš© âŒ
  - name: db-password # ì‹œí¬ë¦¿ì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ì§€ì •
    literals:
      - password=realpassword # í‚¤-ê°’ìŒì„ ìƒì„±

resources: # ë‹¤ë¥¸ YAML íŒŒì¼ë“¤ì„ ë§í¬
  - postgres.yaml
```

&ensp; í¬ìŠ¤íŠ¸ê·¸ë ˆìŠ¤ í¬ë“œì—ì„œ DB ì•”í˜¸ë¡œ ì‚¬ìš©ë  `password` í‚¤ê°€ ì •ì˜ëœ ë„¤ì„ìŠ¤í˜ì´ìŠ¤(`dp-password`)ë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ë¦¬ì†ŒìŠ¤ë¡œ *postgres.yaml*ì„ ì§€ì •í•˜ì—¬ YAML íŒŒì¼ë¡œ ìƒì„±ëœ í¬ë“œê°€ ë§í¬ë˜ê²Œë” ì„¤ì •í•©ë‹ˆë‹¤.

### postgres.yaml

```yaml
# í¬ë“œì˜ ë©”íƒ€ ë°ì´í„°ë¥¼ ì •ì˜
apiVersion: apps/v1
kind: Deployment
metadata:
  name: postgres
  labels:
    app: django-postgres

# í¬ë“œì˜ ìŠ¤í™ì„ ì •ì˜
spec:
  selector:
    matchLabels: # djangoë¼ëŠ” app, í˜¹ì€ postgresë¼ëŠ” tierì˜ í¬ë“œê°€ ìˆëŠ”ì§€ í™•ì¸
      app: django
      tier: postgres

  # ì—†ìœ¼ë©´ í¬ë“œë¥¼ ìƒì„±
  strategy:
    type: Recreate

  template:
    metadata:
      labels:
        app: django
        tier: postgres
    spec:
      # ë„ì»¤ ì»´í¬ì¦ˆ íŒŒì¼ê³¼ ìœ ì‚¬
      containers:
        - name: postgres
          image: postgres:alpine
          ports:
            - containerPort: 5432
              name: postgres
          env:
            - name: POSTGRES_DB
              value: djangodb
            - name: POSTGRES_USER
              value: djangouser
            - name: POSTGRES_PASSWORD
              # kustomization.yamlì—ì„œ ìƒì„±í•œ ì‹œí¬ë¦¿ ë„¤ì„ìŠ¤í˜ì´ìŠ¤(db-password)ì—ì„œ í‚¤(password)ë¡œ ê°’ì„ ì°¾ì•„ ë°˜í™˜
              valueFrom:
                secretKeyRef:
                  name: db-password
                  key: password
          # í¬ë“œì˜ ë¦¬ì†ŒìŠ¤ ì œí•œ
          resources:
            limits:
              memory: "128Mi"
              cpu: "500m"
```

&ensp; ê°„ë‹¨í•˜ê²Œ *kustomization.yaml*ê³¼ *postgres.yaml*ì„ ì •ì˜í–ˆìŠµë‹ˆë‹¤. ì´ ì‘ì„±ëœ YAML íŒŒì¼ë“¤ì„ ë°”íƒ•ìœ¼ë¡œ í¬ìŠ¤íŠ¸ê·¸ë ˆìŠ¤ í¬ë“œë¥¼ ì‹¤í–‰í•  ì°¨ë¡€ì…ë‹ˆë‹¤.

<br/>

## âœ… í¬ë“œ ì‹¤í–‰

### í¬ë“œ ì‹¤í–‰ ëª…ë ¹ì–´

```zsh
kubectl create
kubectl apply
```

&ensp; `kubectl`ì€ ë¡œì»¬ì—ì„œ k8së¥¼ ì œì–´í•˜ê¸° ìœ„í•œ ì»¤ë§¨ë“œ ë¼ì¸ íˆ´ì„ì„ ì–¸ê¸‰í–ˆìŠµë‹ˆë‹¤. `kubectl`ì—ì„œ ë¦¬ì†ŒìŠ¤ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´ë¡œ `kubectl create`ê³¼, `kubectl apply` ë‘ ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤.

- `kubectl create`

  - í‘œí˜„ ê·¸ëŒ€ë¡œ ìƒˆë¡œìš´ ë¦¬ì†ŒìŠ¤ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì–´ (ëª…ë ¹í˜•)
  - ë¦¬ì†ŒìŠ¤ê°€ ì´ë¯¸ ì¡´ì¬í•˜ë‹¤ë©´ ì—ëŸ¬ë¥¼ ë°˜í™˜
  - **ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ë³€ê²½í•  ìˆ˜ ì—†ìŒ**
  - ì •ì  íŒŒì¼ì´ë‚˜ ì˜êµ¬ ë³´ì¡´ ë°ì´í„°ë“¤ì„ ìœ„í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•  ë•Œ ìœ ìš©

- `kubectl apply`

  - `kubectl create`ì˜ ê°œë…ì„ í¬í•¨í•˜ëŠ” ëª…ë ¹ì–´ (ì„ ì–¸í˜•)
  - ë¦¬ì†ŒìŠ¤ê°€ ì´ë¯¸ ì¡´ì¬í•˜ë”ë¼ë„ ì—ëŸ¬ë¥¼ ë°˜í™˜í•˜ì§€ ì•ŠìŒ
  - **YAMLì— ì •ì˜ëœ ìŠ¤í™ê³¼ í˜„ì¬ ì‹¤í–‰ ì¤‘ì˜ ë¦¬ì†ŒìŠ¤ì˜ ìŠ¤í™ ê°„ì— ì°¨ì´ë¥¼ íƒì§€í•˜ì—¬ ë³€ê²½ì‚¬í•­ì„ ì ìš©**
  - ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„± ë° ì—…ë°ì´íŠ¸í•˜ê³  ì‹¶ì„ ë•Œ ìœ ìš©

&ensp; ì €ëŠ” ë‘ ê°œì˜ YAML íŒŒì¼ì„ ì •ì˜í–ˆê³ , ì´ YAML íŒŒì¼ë“¤ì— ì •ì˜ëœ ëŒ€ë¡œ ê°ì²´ë¥¼ ìƒì„±í•˜ê¸°ë¥¼ ì›í•©ë‹ˆë‹¤. ë”°ë¼ì„œ, ì„ ì–¸í˜•ì˜ `kubectl apply`ë¡œ ê°ì²´ë¥¼ ìƒì„±í•˜ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

```zsh
kubectl apply -k deploy/
```

### -k

&ensp; YAML íŒŒì¼ì„ ì ìš©í•˜ì—¬ ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì˜µì…˜ìœ¼ë¡œ `-k`ì™€ `-f`ê°€ ìˆìŠµë‹ˆë‹¤. (ë‘˜ì€ í˜¼ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤) `-f`ëŠ” ë„ì»¤ì—ì„œì™€ ë§ˆì°¬ê°€ì§€ë¡œ íŠ¹ì • íŒŒì¼ë¡œ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ì¼ë°˜ì ì¸ ì˜µì…˜ì´ë©°, `-k`ëŠ” _kustomization.yaml_ íŒŒì¼ì´ ìœ„ì¹˜í•œ ë””ë ‰í† ë¦¬ ê²½ë¡œë¡œ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ì˜µì…˜ì…ë‹ˆë‹¤. í˜„ì¬ ì €ëŠ” _deploy_ í´ë” ì•ˆì— _kustomization.yaml_ íŒŒì¼ì´ ìˆë„ë¡ í–ˆê¸° ë•Œë¬¸ì—, ìœ„ì™€ ê°™ì´ ê²½ë¡œë¥¼ ì…ë ¥í•˜ì—¬ ê°ì²´ë¥¼ ìƒì„±í–ˆìŠµë‹ˆë‹¤.

> -k, --kustomize='': Process a kustomization directory. This flag can't be used together with -f or -R.

&ensp; ì´ì œ ë‹¤ì‹œ ëŒ€ì‹œë³´ë“œë¡œ ê°€ì„œ ë¦¬ì†ŒìŠ¤ ê°ì²´ê°€ ì˜ ìƒì„±ëëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

<br/>

## âœ… ê²°ë¡  : ê²°ê³¼ í™•ì¸

![Kubernetes Dashboard](/assets/images/docs/notebook/k8s/k8s_2.png){:.shadow}

&ensp; í¬ìŠ¤íŠ¸ê·¸ë ˆìŠ¤ ë¦¬ì†ŒìŠ¤ ê°ì²´ê°€ ì˜ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ“š ì¶œì²˜

[How to Deploy Django to Kubernetes: Part 1](https://www.youtube.com/watch?v=fw0KXPLFFgs)

</div>
